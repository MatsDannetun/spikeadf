{
	"name": "CreateSourcePipeline",
	"properties": {
		"activities": [
			{
				"name": "Create Database",
				"type": "Script",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "SourceSQL",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "USE MASTER\nGO\nIF EXISTS (SELECT 1 FROM sys.databases WHERE name='SourceDB')\n    DROP DATABASE SourceDB\nGO\nCREATE DATABASE [SourceDB]"
						}
					]
				}
			},
			{
				"name": "Create tables",
				"description": "",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "Create Database",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "SourceSQL",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "USE SourceDB;\nGO\nIF EXISTS (SELECT TOP 1 * FROM sys.tables WHERE name='NEO_tb') \n    DROP TABLE dbo.NEO_tb;\nGO\n--Create table NEO( i int);\nGO\n\nWITH Ten(N) AS \n(\n    SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL \n    SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL \n    SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1\n)   \nSELECT\n    id = CONVERT(integer, ROW_NUMBER() OVER (ORDER BY T10.N))\n    , (CAST(RAND(CHECKSUM(NEWID()))*3 as int) +1)*100 as MId\nINTO dbo.NEO_tb \nFROM Ten AS T10\nCROSS JOIN Ten T100\nCROSS JOIN Ten T1000\nCROSS JOIN Ten T10000\nCROSS JOIN Ten T100000\nCROSS JOIN Ten T1000000;\nGO\nCREATE CLUSTERED INDEX CIX_id ON dbo.NEO_tb (id);\nGO\n\n--SELECT top 100 * FROM NEO_tb\nSELECT top 100 A.id FROM NEO_tb AS A\nCROSS JOIN NEO_tb AS B\n\n-- \nDECLARE @DateStart DATETIME = '2022-01-01 07:00:00'\n\nSELECT\n--top 1000000 \n    A.Mid\n    --, (CAST(RAND(CHECKSUM(NEWID()))*3 as int) +1)*100 as id\n    , CASE \n        WHEN A.MId=100 THEN 400 \n        WHEN A.MId=200 THEN 500\n        WHEN A.MId=300 THEN 600 \n        ELSE 0\n     END as ctype\n    , CASE \n        WHEN A.MId=100 THEN CAST(RAND(CHECKSUM(NEWID()))*10.8 as real) +15 \n        WHEN A.MId=200 THEN CAST(RAND(CHECKSUM(NEWID()))*10.8 as real) +5 \n        WHEN A.MId=300 THEN CAST(RAND(CHECKSUM(NEWID()))*10.1 as real) +2 \n        ELSE 0\n     END as cvalue\n    , DATEADD(SECOND, id, @DateStart) as tstamp INTO source_tb\nFROM NEO_tb AS A "
						}
					]
				}
			}
		],
		"annotations": []
	}
}